<?phpclass Results extends CI_model {	public function __construct()	{		parent::__construct();		$this->load->database();	}	public function get_total_candidatos($source,$candidatura) {		$query = $this->db->query('		select nombre,partido,foto,ifnull(sum(votos),0) total		from resultado		inner join candidato on resultado.candidato=candidato.id		where source=? and candidatura=?		group by candidato		order by total desc, sequence',array($source,$candidatura));        $result=$query->result();        $color=array('PNP'=>'#0000FF','PPD'=>'#FF0000','PIP'=>'#009933','PPR'=>'#FF9900','OTR'=>'#5D5D5D',					'MUS'=>'#4eb6af','PPT'=>'#68318f','SI'=>'FF0000','NO'=>'0000FF','ESTAD'=>'#0000FF',					'INDEP'=>'#009933','ELAS'=>'#FF0000','IND'=>'#CCCCCC','MAP'=>'#CCCCCC');					        foreach ($result as $row){            $row->foto = base_url('images/'.$row->foto);            $row->partido_img = base_url('images/'.$row->partido.'.png');            $row->color = $color[($row->partido)];        }		return $result;	}	public function get_total_votos($source,$candidatura) {		$query = $this->db->query('		select ifnull(sum(votos),0) total_votos from resultado		inner join candidato on resultado.candidato=candidato.id		where source=? and candidatura=?',array($source,$candidatura));        $result=$query->row();		return $result;	}	public function get_tally_escrutado($source,$candidatura) {		$query = $this->db->query('		select ifnull(sum(inscritos),0) total_inscritos,count(*) unidades from centro c inner join		(select distinct precinto,unidad from resultado		inner join candidato on candidato.id=resultado.candidato		where source=? and candidatura=? and votos<>0) r		on r.precinto=c.precinto and r.unidad=c.unidad',array($source,$candidatura));		$result=$query->row();		return $result;	}	public function get_tally_cargo($source,$candidatura) {		$query = $this->db->query('		select ifnull(sum(inscritos),0) total_inscritos,count(*) unidades from centro c inner join		(select distinct precinto,unidad from resultado		inner join candidato on candidato.id=resultado.candidato		where source=? and candidatura=?) r		on r.precinto=c.precinto and r.unidad=c.unidad',array($source,$candidatura));		$result=$query->row();		return $result;	}	public function get_fields($source,$candidatura,$precinto,$unidad) {		$query = $this->db->query('		select nombre,votos from resultado		inner join candidato on resultado.candidato=candidato.id		where source=? and candidatura=? and precinto=? and unidad=?		order by candidatura,sequence',array($source,$candidatura,$precinto,$unidad));		return $query->result();	}	public function get_graph_totals($source,$candidatura) {		$query = $this->db->query('		select partido, round((sum(votos)/total_votos)* 100,2) porciento		from candidato join			(select sum(votos) total_votos from candidato			inner join resultado on resultado.candidato=candidato.id			where source=? and candidatura=?) t		inner join resultado on resultado.candidato=candidato.id		where source=? and candidatura=?		group by candidato order by sequence',array($source,$candidatura,$source,$candidatura));		return $query->result();	}		public function get_candidatura($candidatura) {		$query = $this->db->query('select descripcion from candidatura where id = ?',$candidatura);		$result=$query->row();				return $result->descripcion;			}}